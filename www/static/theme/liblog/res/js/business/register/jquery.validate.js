!function(s){s.fn.validate=function(t){var i=!!t.isone,r={flag:!1,id:s(this).find("input[type='submit']"),txt:"提交中..."},a={required:function(r){if(""==r.val())return _error(r,"required"),!1},user:function(e){s.ajax({url:"/home/register/isexist",data:{name:e.val(),__CSRF__:s("#csrf").val()},type:"POST",success:function(r){if(0===r.status)return _error(e,"user"),!1}})},isok:function(r){if(!/^[a-zA-Z0-9_]+$/.test(r.val()))return _error(r,"isok"),!1},password:function(r){if(/\s/.test(r.val()))return _error(r,"password"),!1},minpwd:function(r){if(r.val().length<6)return _error(r,"minpwd"),!1},repassword:function(r){if(s("#password").val()!==r.val())return _error(r,"repassword"),!1},email:function(r){var e=r.val();if(e&&!/^\w+@([0-9a-zA-Z]+[.])+[a-z]{2,4}$/.test(e))return _error(r,"email"),!1},checkemail:function(e){s.ajax({url:"/register/checkemail",data:{email:e.val(),__CSRF__:s("#csrf").val()},type:"POST",success:function(r){if(0===r.status)return _error(e,"checkemail"),!1}})},phone:function(r){var e=r.val();if(e&&!/^1[3|5|8|7]\d{9}$/.test(e))return _error(r,"phone"),!1},code:function(r){var e;if(s.ajax({url:"/register/codeisright",data:{code:r.val(),__CSRF__:s("#csrf").val()},type:"POST",success:function(r){e=r.status}}),0===e)return _error(r,"code"),!1},isqq:function(r){var e=r.val();if(e&&!/^\d{5,10}$/.test(e))return _error(r,"isqq"),!1},url:function(r){var e=r.val();if(e&&!/^http:\/\/.+\./.test(e))return _error(r,"url"),!1},idcard:function(r){var e=r.val();if(e&&!/(^\d{15}$)|(^\d{17}([0-9]|X|x)$)/.test(e))return _error(r,"idcard"),!1}},n={required:"必填项不能为空!",isok:"用户名由数字、字母或下划线组成！",user:"用户已存在！",checkemail:"邮箱已存在！",password:"不能包含空格！",minpwd:"密码长度不能低于6位！",repassword:"两次密码输入不一致！",email:"邮箱格式不正确！",phone:"格式不正确！",url:"格式不正确！",code:"验证码错误，请保持大小写一致！",isqq:"格式不正确！",idcard:"格式不正确！"};return t&&(t.messages&&(n=s.extend(n,t.messages)),t.validate&&(a=s.extend(a,t.validate)),t.submitBtn&&(r=s.extend(r,t.submitBtn))),_error=function(r,e){t&&t.error?t.error(r,n[e]):alert(n[e])},function(){var t=!0;return s(this).find("[validate]").each(function(r,e){if(0==function(){for(var r=s(this).attr("validate").split("|"),e=r.length,t=0;t<e;t++)if(a.hasOwnProperty(r[t])&&0==a[r[t]](s(this)))return!1}.call(e)&&(t=!1,i))return!1}),t&&r.flag&&r.id.val(r.txt),t}.call(this)}}(jQuery);