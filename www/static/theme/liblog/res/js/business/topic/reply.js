var editor=new wangEditor("editor");editor.config.menus=["bold","underline","italic","fontsize","strikethrough","unorderlist","orderlist","img","link","forecolor","bgcolor","location","table","emotion","insertcode","eraser","fullscreen"],editor.config.uploadParams={__CSRF__:G_csrf},editor.config.emotions={default:{title:"默认",data:"/static/theme/liblog/res/emotions.data"}},editor.config.uploadImgFileName="img",editor.config.uploadImgUrl="/topic/create/uploadeditor",editor.create(),$("#savetopic").click(function(){var t=editor.$txt.html(),e=editor.$txt.text();if(""===$.trim(e))return $(".reply-error").remove(),$("#savetopic").after('<span class="reply-error">回复内容不能为空！</span>'),!1;$(".reply-error").remove();var r={tid:$("#tid").val(),title:$("#replytitle").val(),comment:e,oldcomment:t,pic:$("#replypic").val(),author:$("#replyauthor").val(),createtime:new Date,__CSRF__:G_csrf};$.ajax({url:"/topic/create/savereply",data:r,type:"POST",success:function(t){0===t.errno?window.location.href="/topic/item/"+$("#tid").val():alert(t.errmsg)}})}),$(".reply_item").delegate(".reply2_btn","click",function(){var t=$(this).attr("rname"),e='<a href="/personal/@'+t+'" target="_blank">@'+t+"</a>";editor.$txt.html(e);var r=$("#createreply").offset().top;$("html,body").animate({scrollTop:r})}),$(".replylist").delegate(".reply_item","mouseover",function(){$(this).find(".fa-thumbs-o-up").removeClass("invisible")}),$(".replylist").delegate(".reply_item","mouseout",function(){$(this).find(".fa-thumbs-o-up").addClass("invisible")}),$(".replylist").delegate(".fa-thumbs-o-up","click",function(){var r=$(this),t={id:$(this).attr("rid"),likers:$(this).attr("login"),__CSRF__:G_csrf};$.ajax({url:"/topic/create/postlike",data:t,type:"POST",success:function(t){if(0===t.errno){var e=r.parent().find(".likeCount");0===t.data.likeCount?(r.removeClass("haslike"),e.html("")):(e.html(t.data.likeCount),r.addClass("haslike"))}else alert(t.errmsg)}})}),$(".replylist").delegate(".fa-trash","click",function(){var e=$(this),t={id:$(this).attr("rid"),tid:$(this).attr("tid"),__CSRF__:G_csrf};confirm("确定删除？")&&$.ajax({url:"/topic/create/removereply",data:t,type:"POST",success:function(t){0===t.errno?e.parents(".reply_item").remove():alert(t.errmsg)}})}),$("#removeItem").on("click",function(){$(this);var t={id:$(this).attr("rid"),__CSRF__:G_csrf};confirm("确定删除？")&&$.ajax({url:"/topic/create/removeitem",data:t,type:"POST",success:function(t){0===t.errno?window.location.href="/topic":alert(t.errmsg)}})}),$("#saveedittopic").click(function(){var t=editor.$txt.html(),e=editor.$txt.text(),r=editor.$txt.text(),i={id:$(this).attr("rid"),tid:$("#tid").val(),title:$("#replytitle").val(),comment:r,oldcomment:t,pic:$("#replypic").val(),author:$("#replyauthor").val(),createtime:new Date,__CSRF__:G_csrf};if(""===$.trim(e))return $(".reply-error").remove(),$("#saveedittopic").after('<span class="reply-error">回复内容不能为空！</span>'),!1;$.ajax({url:"/topic/create/savereply",data:i,type:"POST",success:function(t){0===t.errno?window.location.href="/topic/item/"+$("#tid").val():(alert(t.errmsg),window.location.href="/topic")}})});